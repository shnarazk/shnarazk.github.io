__NUXT_JSONP__("/2020/2020-04-11-emacs27-on-nix", {data:[{article:Object.create(null,{default:{writable:true,enumerable:true,value:{title:"Building Emacs27.nix on MacOS",subtitle:"as an overlay",date:"2020-04-11T00:00:00.000Z",tags:["NixOS","Emacs"],bodyContent:"* `?`を使ったカスタマイズはemacsをオーバーレイする前に解決されてしまっているので`call-process`を呼び\n  出すのでなければ、（`nativeBuildInputs`に対してやっているように）自前で各アトリビュートを上書きするしかない。\n* なんか`rev`が無視されているような気がする -\u003E ちゃんとダミー値を与えて一回失敗させないといけない。\n  これでちゃんと更新されるようになった。\n\n```\n# ~\u002F.config\u002Fnixpkgs\u002Foverlays\u002Femacs27.nix\nself: super:\n{\n  emacs27 = super.emacs.overrideAttrs (attrs: rec {\n    pname = \"emacs27\";\n    # srcRepo = true;\n    name = \"emacs27-${version}\";\n    version = \"27.0.90\";\n    src = super.fetchFromGitHub {\n      owner = \"emacs-mirror\";\n      repo = \"emacs\";\n      rev = \"6057d79a4eb4b95037068a1e9335a2418b2da5ec\";\n      hash = \"sha256:11111111111111111111111111111111111111111111111111111\";\n      #hash = \"sha256:0dyb08afrkfic765zkwy27nnj0h8ays5likgfbdhwhbpdnmrgv8x\";\n    };\n    patches = [];\n    preConfigure = ''\n      .\u002Fautogen.sh\n    '' + ''\n      substituteInPlace lisp\u002Finternational\u002Fmule-cmds.el \\\n        --replace \u002Fusr\u002Fshare\u002Flocale ${super.gettext}\u002Fshare\u002Flocale\n  \n      for makefile_in in $(find . -name Makefile.in -print); do\n          substituteInPlace $makefile_in --replace \u002Fbin\u002Fpwd pwd\n      done\n    '';\n    nativeBuildInputs = [ super.pkgconfig ]\n      ++ [ super.autoconf super.automake super.texinfo ];\n    buildInputs = super.emacs.buildInputs\n        ++ [ super.autoconf super.automake super.texinfo ]\n\t++ [ AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit ImageCaptureCore GSS ImageIO ];\n    inherit (super.darwin.apple_sdk.frameworks)\n        AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit\n        ImageCaptureCore GSS ImageIO;\n  });\n}\n```",bodyHtml:"\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003E?\u003C\u002Fcode\u003Eを使ったカスタマイズはemacsをオーバーレイする前に解決されてしまっているので\u003Ccode\u003Ecall-process\u003C\u002Fcode\u003Eを呼び\n出すのでなければ、（\u003Ccode\u003EnativeBuildInputs\u003C\u002Fcode\u003Eに対してやっているように）自前で各アトリビュートを上書きするしかない。\u003C\u002Fli\u003E\n\u003Cli\u003Eなんか\u003Ccode\u003Erev\u003C\u002Fcode\u003Eが無視されているような気がする -&gt; ちゃんとダミー値を与えて一回失敗させないといけない。\nこれでちゃんと更新されるようになった。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode\u003E# ~\u002F.config\u002Fnixpkgs\u002Foverlays\u002Femacs27.nix\nself: super:\n{\n  emacs27 = super.emacs.overrideAttrs (attrs: rec {\n    pname = &quot;emacs27&quot;;\n    # srcRepo = true;\n    name = &quot;emacs27-${version}&quot;;\n    version = &quot;27.0.90&quot;;\n    src = super.fetchFromGitHub {\n      owner = &quot;emacs-mirror&quot;;\n      repo = &quot;emacs&quot;;\n      rev = &quot;6057d79a4eb4b95037068a1e9335a2418b2da5ec&quot;;\n      hash = &quot;sha256:11111111111111111111111111111111111111111111111111111&quot;;\n      #hash = &quot;sha256:0dyb08afrkfic765zkwy27nnj0h8ays5likgfbdhwhbpdnmrgv8x&quot;;\n    };\n    patches = [];\n    preConfigure = ''\n      .\u002Fautogen.sh\n    '' + ''\n      substituteInPlace lisp\u002Finternational\u002Fmule-cmds.el \\\n        --replace \u002Fusr\u002Fshare\u002Flocale ${super.gettext}\u002Fshare\u002Flocale\n  \n      for makefile_in in $(find . -name Makefile.in -print); do\n          substituteInPlace $makefile_in --replace \u002Fbin\u002Fpwd pwd\n      done\n    '';\n    nativeBuildInputs = [ super.pkgconfig ]\n      ++ [ super.autoconf super.automake super.texinfo ];\n    buildInputs = super.emacs.buildInputs\n        ++ [ super.autoconf super.automake super.texinfo ]\n\t++ [ AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit ImageCaptureCore GSS ImageIO ];\n    inherit (super.darwin.apple_sdk.frameworks)\n        AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit\n        ImageCaptureCore GSS ImageIO;\n  });\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n",dir:"article\u002F.json\u002F2020",base:"2020-04-11-emacs27-on-nix.json",ext:".json",sourceBase:"2020-04-11-emacs27-on-nix.md",sourceExt:".md"}},title:{writable:true,enumerable:true,value:"Building Emacs27.nix on MacOS"},subtitle:{writable:true,enumerable:true,value:"as an overlay"},date:{writable:true,enumerable:true,value:"2020-04-11T00:00:00.000Z"},tags:{writable:true,enumerable:true,value:["NixOS","Emacs"]},bodyContent:{writable:true,enumerable:true,value:"* `?`を使ったカスタマイズはemacsをオーバーレイする前に解決されてしまっているので`call-process`を呼び\n  出すのでなければ、（`nativeBuildInputs`に対してやっているように）自前で各アトリビュートを上書きするしかない。\n* なんか`rev`が無視されているような気がする -\u003E ちゃんとダミー値を与えて一回失敗させないといけない。\n  これでちゃんと更新されるようになった。\n\n```\n# ~\u002F.config\u002Fnixpkgs\u002Foverlays\u002Femacs27.nix\nself: super:\n{\n  emacs27 = super.emacs.overrideAttrs (attrs: rec {\n    pname = \"emacs27\";\n    # srcRepo = true;\n    name = \"emacs27-${version}\";\n    version = \"27.0.90\";\n    src = super.fetchFromGitHub {\n      owner = \"emacs-mirror\";\n      repo = \"emacs\";\n      rev = \"6057d79a4eb4b95037068a1e9335a2418b2da5ec\";\n      hash = \"sha256:11111111111111111111111111111111111111111111111111111\";\n      #hash = \"sha256:0dyb08afrkfic765zkwy27nnj0h8ays5likgfbdhwhbpdnmrgv8x\";\n    };\n    patches = [];\n    preConfigure = ''\n      .\u002Fautogen.sh\n    '' + ''\n      substituteInPlace lisp\u002Finternational\u002Fmule-cmds.el \\\n        --replace \u002Fusr\u002Fshare\u002Flocale ${super.gettext}\u002Fshare\u002Flocale\n  \n      for makefile_in in $(find . -name Makefile.in -print); do\n          substituteInPlace $makefile_in --replace \u002Fbin\u002Fpwd pwd\n      done\n    '';\n    nativeBuildInputs = [ super.pkgconfig ]\n      ++ [ super.autoconf super.automake super.texinfo ];\n    buildInputs = super.emacs.buildInputs\n        ++ [ super.autoconf super.automake super.texinfo ]\n\t++ [ AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit ImageCaptureCore GSS ImageIO ];\n    inherit (super.darwin.apple_sdk.frameworks)\n        AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit\n        ImageCaptureCore GSS ImageIO;\n  });\n}\n```"},bodyHtml:{writable:true,enumerable:true,value:"\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003E?\u003C\u002Fcode\u003Eを使ったカスタマイズはemacsをオーバーレイする前に解決されてしまっているので\u003Ccode\u003Ecall-process\u003C\u002Fcode\u003Eを呼び\n出すのでなければ、（\u003Ccode\u003EnativeBuildInputs\u003C\u002Fcode\u003Eに対してやっているように）自前で各アトリビュートを上書きするしかない。\u003C\u002Fli\u003E\n\u003Cli\u003Eなんか\u003Ccode\u003Erev\u003C\u002Fcode\u003Eが無視されているような気がする -&gt; ちゃんとダミー値を与えて一回失敗させないといけない。\nこれでちゃんと更新されるようになった。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre\u003E\u003Ccode\u003E# ~\u002F.config\u002Fnixpkgs\u002Foverlays\u002Femacs27.nix\nself: super:\n{\n  emacs27 = super.emacs.overrideAttrs (attrs: rec {\n    pname = &quot;emacs27&quot;;\n    # srcRepo = true;\n    name = &quot;emacs27-${version}&quot;;\n    version = &quot;27.0.90&quot;;\n    src = super.fetchFromGitHub {\n      owner = &quot;emacs-mirror&quot;;\n      repo = &quot;emacs&quot;;\n      rev = &quot;6057d79a4eb4b95037068a1e9335a2418b2da5ec&quot;;\n      hash = &quot;sha256:11111111111111111111111111111111111111111111111111111&quot;;\n      #hash = &quot;sha256:0dyb08afrkfic765zkwy27nnj0h8ays5likgfbdhwhbpdnmrgv8x&quot;;\n    };\n    patches = [];\n    preConfigure = ''\n      .\u002Fautogen.sh\n    '' + ''\n      substituteInPlace lisp\u002Finternational\u002Fmule-cmds.el \\\n        --replace \u002Fusr\u002Fshare\u002Flocale ${super.gettext}\u002Fshare\u002Flocale\n  \n      for makefile_in in $(find . -name Makefile.in -print); do\n          substituteInPlace $makefile_in --replace \u002Fbin\u002Fpwd pwd\n      done\n    '';\n    nativeBuildInputs = [ super.pkgconfig ]\n      ++ [ super.autoconf super.automake super.texinfo ];\n    buildInputs = super.emacs.buildInputs\n        ++ [ super.autoconf super.automake super.texinfo ]\n\t++ [ AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit ImageCaptureCore GSS ImageIO ];\n    inherit (super.darwin.apple_sdk.frameworks)\n        AppKit Carbon Cocoa IOKit OSAKit Quartz QuartzCore WebKit\n        ImageCaptureCore GSS ImageIO;\n  });\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n"},dir:{writable:true,enumerable:true,value:"article\u002F.json\u002F2020"},base:{writable:true,enumerable:true,value:"2020-04-11-emacs27-on-nix.json"},ext:{writable:true,enumerable:true,value:".json"},sourceBase:{writable:true,enumerable:true,value:"2020-04-11-emacs27-on-nix.md"},sourceExt:{writable:true,enumerable:true,value:".md"}})}],fetch:[],mutations:[]});
---
title: EMA of LBD
subtitle: LBDはリスタートに利用できるのか
date: 2019-07-15
tags: ['SAT', 'issue']
---

学習節の平均 LBD は大きく揺れすぎ。節削減の影響もあるので節の持つ数値は使いにくい気がする。
そんなこともあって、統計処理したからといって探索パラメータとしては使いにくいのではないだろうか。
むしろ個々の学習節の生データで戦略を決定した方がいいかもしれない。ともあれ、データを取ってみよう。

まずは、枝刈り（悪い状態からの離脱）の効果に関して。

#### A. CHB branch から普通のやつ

```
"splr-014",     1, "3/SAT/v360-c1530/002",  96.128
"splr-014",     2, "3/SAT/v360-c1530/030",  95.274
"splr-014",     3, "3/SAT/v360-c1530/033",  23.848
"splr-014",     4, "3/SAT/v360-c1530/035",   1.671
"splr-014",     5, "3/SAT/v360-c1530/039",   ABORT
"splr-014",     6, "3/SAT/v360-c1530/051",  11.890
"splr-014",     7, "3/SAT/v360-c1530/060",   9.373
"splr-014",     8, "3/SAT/v360-c1530/073", 170.834
"splr-014",     9, "3/SAT/v360-c1530/087",   3.912
"splr-014",    10, "3/SAT/v360-c1530/093",   1.180
"splr-014",    11, "3/UNS/v360-c1530/001",   ABORT
"splr-014",    12, "3/UNS/v360-c1530/015",   ABORT
"splr-014",    13, "3/UNS/v360-c1530/028",   ABORT
"splr-014",    14, "3/UNS/v360-c1530/029",   ABORT
"splr-014",    15, "3/UNS/v360-c1530/031",   ABORT
"splr-014",    16, "3/UNS/v360-c1530/053",   ABORT
"splr-014",    17, "3/UNS/v360-c1530/061",   ABORT
"splr-014",    18, "3/UNS/v360-c1530/086",   ABORT
"splr-014",    19, "3/UNS/v360-c1530/089",   ABORT
"splr-014",    20, "3/UNS/v360-c1530/096", 372.583
9 SATs + 1 UNS

T56.2.0.cnf                                3145220,10854665 |time:   721.82
 #conflict:     319339, #decision:      1751376, #propagate:      965031514
  Assignment|#rem:   748607, #fix:     7573, #elm:  2389040, prg%:  76.1986
 Clause Kind|Remv:   105560, LBD2:    35076, Binc:    19760, Perm:  5453978
     Restart|#BLK:     1721, #RST:     1409, eASG:   0.0169, eLBD:   0.6303
    Conflict|aLBD:     4.70, bjmp:     9.00, cnfl:    40.03 |#stg:        0
   Clause DB|#rdc:       12, #sce:      463 |blkR:   1.4000, frcK:   0.7000
    Strategy|mode: Non-Specific-Instance using generic settings
```

#### B. そこから `force_restart` における `ema_lbd` による起動条件を抜いたもの

```
"splr-014",     1, "3/SAT/v360-c1530/002", 140.964
"splr-014",     2, "3/SAT/v360-c1530/030",   ABORT
"splr-014",     3, "3/SAT/v360-c1530/033",  28.289
"splr-014",     4, "3/SAT/v360-c1530/035",  16.645
"splr-014",     5, "3/SAT/v360-c1530/039",   ABORT
"splr-014",     6, "3/SAT/v360-c1530/051",   ABORT
"splr-014",     7, "3/SAT/v360-c1530/060",   ABORT
"splr-014",     8, "3/SAT/v360-c1530/073",  19.148
"splr-014",     9, "3/SAT/v360-c1530/087",   0.886
"splr-014",    10, "3/SAT/v360-c1530/093",  72.789
"splr-014",    11, "3/UNS/v360-c1530/001",   ABORT
"splr-014",    12, "3/UNS/v360-c1530/015", 491.248
"splr-014",    13, "3/UNS/v360-c1530/028",   ABORT
"splr-014",    14, "3/UNS/v360-c1530/029",   ABORT
"splr-014",    15, "3/UNS/v360-c1530/031",   ABORT
"splr-014",    16, "3/UNS/v360-c1530/053",   ABORT
"splr-014",    17, "3/UNS/v360-c1530/061",   ABORT
"splr-014",    18, "3/UNS/v360-c1530/086", 463.417
"splr-014",    19, "3/UNS/v360-c1530/089",   ABORT
"splr-014",    20, "3/UNS/v360-c1530/096", 445.640
6 SATs + 3 UNSs

T56.2.0.cnf                                3145220,10854665 |time:   944.43
 #conflict:     341071, #decision:      2311368, #propagate:     1254204513
  Assignment|#rem:   697575, #fix:    32350, #elm:  2415295, prg%:  77.8211
 Clause Kind|Remv:    48361, LBD2:    34735, Binc:    21108, Perm:  4918971
     Restart|#BLK:      620, #RST:     4765, eASG:   0.0195, eLBD:   0.5683
    Conflict|aLBD:     4.92, bjmp:    10.17, cnfl:    51.10 |#stg:        0
   Clause DB|#rdc:       13, #sce:      623 |blkR:   1.5000, frcK:   0.7000
    Strategy|mode: Non-Specific-Instance using generic settings
```

#### C. `block_restart` における `ema_asg`による封鎖条件を抜いたもの

```
"splr-014",     1, "3/SAT/v360-c1530/002",  96.975
"splr-014",     2, "3/SAT/v360-c1530/030",  96.883
"splr-014",     3, "3/SAT/v360-c1530/033",  24.184
"splr-014",     4, "3/SAT/v360-c1530/035",   1.684
"splr-014",     5, "3/SAT/v360-c1530/039",   ABORT
"splr-014",     6, "3/SAT/v360-c1530/051",  11.985
"splr-014",     7, "3/SAT/v360-c1530/060",   9.571
"splr-014",     8, "3/SAT/v360-c1530/073", 169.442
"splr-014",     9, "3/SAT/v360-c1530/087",   3.957
"splr-014",    10, "3/SAT/v360-c1530/093",   1.188
"splr-014",    11, "3/UNS/v360-c1530/001",   ABORT
"splr-014",    12, "3/UNS/v360-c1530/015",   ABORT
"splr-014",    13, "3/UNS/v360-c1530/028",   ABORT
"splr-014",    14, "3/UNS/v360-c1530/029",   ABORT
"splr-014",    15, "3/UNS/v360-c1530/031",   ABORT
"splr-014",    16, "3/UNS/v360-c1530/053",   ABORT
"splr-014",    17, "3/UNS/v360-c1530/061",   ABORT
"splr-014",    18, "3/UNS/v360-c1530/086",   ABORT
"splr-014",    19, "3/UNS/v360-c1530/089",   ABORT
"splr-014",    20, "3/UNS/v360-c1530/096", 350.507
9 SATs + 1 UNS

T56.2.0.cnf                                3145220,10854665 |time:   605.01
 #conflict:     320514, #decision:      1747366, #propagate:      781715799
  Assignment|#rem:   694683, #fix:    35089, #elm:  2415448, prg%:  77.9131
 Clause Kind|Remv:    74302, LBD2:    34334, Binc:    19331, Perm:  5006638
     Restart|#BLK:     5739, #RST:      662, eASG:   0.0147, eLBD:   0.6291
    Conflict|aLBD:     4.94, bjmp:     9.16, cnfl:    52.13 |#stg:        0
   Clause DB|#rdc:       12, #sce:      395 |blkR:   1.3000, frcK:   0.7000
    Strategy|mode: Non-Specific-Instance using generic settings
```

わかったこと：

- 3SAT 問題では、restart しない方が UNSAT 問題は解ける
- 大規模問題ではよさそうなものに投資するのは効果が薄い
- 大規模問題および UNSAT 3SAT では尺度（LBD）がすでに悪くなっているものからはすぐに撤退すべき
- UNSAT 3SAT では`force_restart`の頻度を減らす方がいいと言うのは意外（というか薄々感じていたことに対する新たな物証）。
  やはり解けない部分問題を徹底的に深く見ないと問題が解けないことはわからないのではないだろうか。。。

と言うことで悪い状態から脱出する方法はかなり重要。不確実な未来予測（deep search）よりもこちらを優先すべきのようだ。
つまり'measure for forcing blocking'をどう設計するかが問題。そしてコーディングレベルでは`block_restart`よりも`force_restart`の実装がより重要である。EMA of VAD を考えるべきだろうか。。。

そしてなぜ矛盾が発生していない（節にも変数活性度にも影響が及ばない）パスの中に `force＿restart` が埋め込まれているんだろうか？
この設計は必要か? さらに言うと最新の学習節を追加する前の状態で判断することに意味あるのだろうか。
学習節が追加されたら 1 度は`propagate`させる必要があるのはわかる。このタイミングで 3 方向分岐すればいいのでは。
